let lastScriptUptime=null;function formatDuration(t){const e=Math.floor(t/86400),n=Math.floor(t%86400/3600),a=Math.floor(t%3600/60),o=Math.floor(t%60),s=[];return e>0&&s.push(`${e}d`),n>0&&s.push(`${n}h`),a>0&&s.push(`${a}m`),o>0&&s.push(`${o}s`),s.length>0?s.join(" "):"0s"}async function loadInfo(){async function t(t){try{const e=await fetch(t);return e.ok?await e.json():null}catch{return null}}const e=await t("/api/script_uptime"),n=document.getElementById("scriptUptime");if(e?.data&&"number"==typeof e.data.script_uptime){const t=e.data.script_uptime;n.textContent=null!==lastScriptUptime&&t===lastScriptUptime?"Not Running":formatDuration(t),lastScriptUptime=t}else n.textContent="Not Running",lastScriptUptime=null;const a=await t("/api/system_uptime");a?.data&&(document.getElementById("systemUptime").textContent=formatDuration(a.data.system_uptime));const o=await t("/api/ram");if(o?.data){const t=(o.data.ram_used/1024**3).toFixed(1),e=(o.data.ram_total/1024**3).toFixed(1);document.getElementById("ram").textContent=`${t} GiB / ${e} GiB`}const s=await t("/api/health_interval");if(s?.data){const t=Math.round(s.data.health_interval_sec/60);document.getElementById("healthInterval").textContent=`${t} min`}const i=await t("/api/log_interval");i?.data&&(document.getElementById("logInterval").textContent=`${i.data.log_interval_min} min`);const l=await t("/api/status");l?.data&&(document.getElementById("statusMsg").textContent=l.data.status);const r=await t("/api/log_entry");r?.data&&(document.getElementById("logEntry").textContent=r.data.log_entry)}async function control(t){const e=document.querySelector("#statusMessage span");e.textContent="",e.style.color="";try{const n=await fetch(`/api/control/${t}`,{method:"POST"}),a=await n.json();"ok"===a.status?(e.textContent="✓ "+a.message,e.style.color="green"):(e.textContent="✗ "+a.message,e.style.color="red"),setTimeout((()=>{e.textContent="",e.style.color=""}),6e4)}catch(t){e.textContent="✗ "+t,e.style.color="red",setTimeout((()=>{e.textContent="",e.style.color=""}),12e4)}}document.addEventListener("DOMContentLoaded",(()=>{loadInfo(),setInterval(loadInfo,6e4)}));