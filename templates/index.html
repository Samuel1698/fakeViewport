<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Viewport Control</title>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon-96x96.png')}}" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg')}}" />
  <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico')}}" />
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon.png')}}" />
  <meta name="apple-mobile-web-app-title" content="Viewport" />
  <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest')}}" />
  <link rel="preload" href="{{ url_for('static', filename='UI_Sans.woff2') }}" as="font" type="font/woff2">
  <link rel="stylesheet" href="{{ url_for('static', filename='main-min.css') }}">
</head>
<body>
  <h1>Viewport Control</h1>
  <section id="navigation">
    <div class="button-group">
      <button id="statusBtn" aria-selected="true">Status</button>
      <button id="infoBtn">Info</button>
      <button id="configBtn">Config</button>
      <button id="logsBtn">Logs</button>
      <button id="updateBtn" hidden>Update</button>
    </div>
    <button id="refreshButton">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
        <g id="refresh">
          <path
            d="M7.59375 3L9.0625 5L13 5C16.324219 5 19 7.675781 19 11L19 15L16 15L20 20.46875L24 15L21 15L21 11C21 6.59375 17.40625 3 13 3ZM4 3.53125L0 9L3 9L3 13C3 17.40625 6.59375 21 11 21L16.40625 21L14.9375 19L11 19C7.675781 19 5 16.324219 5 13L5 9L8 9Z" />
        </g>
      </svg>
    </button>
  </section>
  <section id="status" class="display">
    <div class="wrapper">
      <ul>
        <li><span>Script Uptime:</span><span id="scriptUptime" class="Green">-</span></li>
        <li><span>System Uptime:</span><span id="systemUptime">-</span></li>
        <li>
          <span>Throughput:</span>
          <span class="network">
            <svg viewBox="0 0 20 20" class="down" fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="16px" height="16px"
            class="css-network-m4svol Icon-module_icon__2a0I8 Icon-module_icon-light__27kpC Icon-module_icon-outline__3nv5v"
            baseclassname="" twotonedclassname="Icon-module_hidden__cSK0B" fillclassname="Icon-module_hidden__cSK0B"
            fillwithtwotoneclassname="Icon-module_hidden__cSK0B" stroke="currentColor" stroke-width="0">
            <path fill-rule="evenodd" clip-rule="evenodd"
            d="M13.883 12.904a.5.5 0 0 1 .707.707l-4.243 4.243a.5.5 0 0 1-.707 0L5.396 13.61a.5.5 0 0 1 .707-.707l3.39 3.39V2.5a.5.5 0 0 1 1 0v13.793l3.39-3.389Z"
            fill="currentColor" class=""></path>
            </svg>
            <span id="down" class="down"></span>
            <svg viewBox="0 0 21 20" class="up" fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="16px" height="16px"
              class="css-network-3taki8 Icon-module_icon__2a0I8 Icon-module_icon-light__27kpC Icon-module_icon-outline__3nv5v"
              baseclassname="" twotonedclassname="Icon-module_hidden__cSK0B" fillclassname="Icon-module_hidden__cSK0B"
              fillwithtwotoneclassname="Icon-module_hidden__cSK0B" stroke="currentColor" stroke-width="0">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M13.893 7.096a.5.5 0 0 0 .707-.707l-4.243-4.243a.5.5 0 0 0-.707 0L5.406 6.39a.5.5 0 0 0 .707.707l3.39-3.39V17.5a.5.5 0 0 0 1 0V3.707l3.39 3.389Z"
                fill="currentColor" class=""></path>
            </svg>
            <span id="up" class="up"></span>
          </span>
        </li>
        <li><span>Scheduled Restart:</span><span id="scheduledRestart">-</span></li>
        <li><span>Last Status Message: </span><span id="statusMsg">-</span></li>
        <li><span>Last Log Entry: </span><span id="logEntry">-</span></li>
      </ul>
    </div>
    <div class="controls" data-tooltip="Please wait before sending the same command again.">
      <button data-action="start">Start</button>
      <button data-action="restart">Restart</button>
      <button data-action="quit">Quit</button>
    </div>
    <div class="statusMessage"><span></span></div>
  </section>
  <section id="info" class="display" hidden>
    <div class="wrapper">
      <ul>
        <li><span>Script Version:</span><span id="version">-</span></li>
        <li><span>Operating System:</span><span id="osInfo">-</span></li>
        <li><span>Device:</span><span id="hardwareInfo">-</span></li>
        <li><span>CPU Usage:</span><span id="cpuInfo">-</span></li>
        <li><span>RAM Used / Total:</span><span id="ramInfo">-</span></li>
        <li><span>Space Available:</span><span id="diskInfo">-</span></li>
      </ul>
    </div>
    <div class="controls" data-tooltip="Please wait before sending the same command again.">
      <button data-action="start">Start</button>
      <button data-action="restart">Restart</button>
      <button data-action="quit">Quit</button>
    </div>
    <div class="statusMessage"><span></span></div>
  </section>
  <section id="config" class="display" hidden>
    <div class="wrapper">
      <ul>
        <li><span>Health Check Interval:</span><span id="healthInterval" data-tooltip="SLEEP_TIME | Time in between health checks" data-api-key="general.health_interval_sec">-</span></li>
        <li><span>Log Healthy Every:</span><span id="logInterval" data-tooltip="LOG_INTERVAL | Minutes between status log entries" data-api-key="logging.log_interval_min">-</span></li>
        <li><span>Seconds to Wait Before Error:</span><span id="waitTime" data-tooltip="WAIT_TIME | Max seconds to wait for page elements (loads, camera feeds, buttons) before error" data-api-key="general.wait_time_sec">-</span></li>
        <li><span>Retry Attempts Before Restarting:</span><span data-tooltip="MAX_RETRIES | Number of retry attempts on failures (page reloads → browser restart → script restart). Minimum 3" id="maxRetries"  data-api-key="general.max_retries">-</span></li>
        <li><span>Restart Times:</span><span id="restartTimes" data-tooltip="RESTART_TIMES | Comma-separated 24h times (HH:MM) for automatic script restart" data-api-key="general.restart_times">-</span></li>
      </ul>
    </div>
    <div class="wrapper">
      <ul>
        <li><span>Binary:</span><span id="profileBinary" data-tooltip="BROWSER_BINARY | Executable Path/Application Binary without the --flags" data-api-key="browser.binary_path">-</span></li>
        <li><span>Profile Path:</span><span id="profilePath" data-tooltip="BROWSER_PROFILE_PATH | Custom profile directory without the trailing 'Default'" data-api-key="browser.profile_path">-</span></li>
        <li><span>Headless:</span><span id="headless" data-tooltip="HEADLESS | Useful only for testing" data-api-key="browser.headless">-</span></li>
      </ul>
    </div>
    <div class="wrapper">
      <ul>
        <li><span>Retain Logs for:</span><span id="logDays" data-tooltip="LOG_DAYS | Retain this many days of logs and screenshots" data-api-key="logging.log_days">-</span></li>
        <li><span>Write to Log File:</span><span id="logFile" data-tooltip="LOG_FILE_FLAG | Write to the logfile" data-api-key="logging.log_file_flag">-</span></li>
        <li><span>Write to Console:</span><span id="logConsole" data-tooltip="LOG_CONSOLE | Write to the console" data-api-key="logging.log_console_flag">-</span></li>
        <li><span>Error Logging:</span><span id="errorLogging" data-tooltip="ERROR_LOGGING | On errors, raise exception (more verbose)" data-api-key="logging.error_logging">-</span></li>
        <li><span>Debug Logging:</span><span id="debugLogging" data-tooltip="DEBUG_LOGGING | Use DEBUG logging level instead of INFO" data-api-key="logging.debug_logging">-</span></li>
        <li><span>Take Screenshots on Errors:</span><span id="screenshots" data-tooltip="ERROR_PRTSCR | On errors, capture screenshot" data-api-key="logging.ERROR_PRTSCR">-</span></li>
      </ul>
    </div>
  </section>
  <section id="logs" hidden>
    <div class="wrapper">
      <div class="container">
        <h2>Last <span id="logCount">50</span> Log Entries</h2>
        <div class="log-controls">
          <div class="custom-spinners">
            <button class="custom-spinner-btn" data-action="increment">▲</button>
            <button class="custom-spinner-btn" data-action="decrement">▼</button>
          </div>
          <input type="number" id="logLimit" min="10" max="600" value="10" step="10">
          <button id="searchLogs">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
          </button>
        </div>
      </div>
      <div id="logOutput"></div>
      <button id="expandLogs" class="expand-button" aria-label="Expand logs">
        <svg width="32" height="24" viewBox="0 0 24 24">
          <path d="M8 5v14l-11-7z" />
          <path d="M12 5v14l11-7z" />
        </svg>
      </button>
    </div>
  </section>
  <section id="update" hidden>
    <div class="wrapper">
      <div class="container">
        <h2>Update</h2>
      </div>
      <div id="changelog-body"></div>
      <div class="flex">
        <a id="changelog-link" href="#" target="_blank">View on GitHub</a>
        <button type="submit"><span>Update</span></button>
      </div>
      <div id="updateMessage"><span></span></div>
    </div>
  </section>
  <script src="{{ url_for('static', filename='marked-min.js') }}" defer></script>
  <script src="{{ url_for('static', filename='main-min.js') }}" defer></script>
</body>
</html>